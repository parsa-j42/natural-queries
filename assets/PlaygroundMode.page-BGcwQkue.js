import{r as o,u as B,g as G,j as e,C as H,T as M,b as t,h as u,A as p,i as j,P as w,k as C,l as O,B as f,m as c,G as F,n as r,o as q,p as V,q as l,c as J}from"./mantine-gaEAkGgm.js";import{aG as K,aH as $,aI as U,aJ as Y}from"./SchemaViewer-ZWqKlDMj.js";import{u as X}from"./index-Dcdo9pRS.js";import{c as x}from"./createReactComponent-BDw6330a.js";import"./react-vendor-CNHA2c5_.js";/**
 * @license @tabler/icons-react v3.24.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z=x("outline","bookmark","IconBookmark",[["path",{d:"M18 7v14l-6 -4l-6 4v-14a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.24.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ee=x("outline","code","IconCode",[["path",{d:"M7 8l-4 4l4 4",key:"svg-0"}],["path",{d:"M17 8l4 4l-4 4",key:"svg-1"}],["path",{d:"M14 4l-4 16",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.24.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var se=x("outline","history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.24.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ae=x("outline","terminal-2","IconTerminal2",[["path",{d:"M8 9l3 3l-3 3",key:"svg-0"}],["path",{d:"M13 15l3 0",key:"svg-1"}],["path",{d:"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-2"}]]);const te="_header_7w0ta_1",le="_title_7w0ta_8",ne="_actions_7w0ta_13",ie="_historyPanel_7w0ta_18",re="_historyItem_7w0ta_23",oe="_historyArrow_7w0ta_36",ce="_querySection_7w0ta_46",de="_inputGroup_7w0ta_51",he="_inputWrapper_7w0ta_57",me="_inputIcon_7w0ta_62",ue="_queryInput_7w0ta_71",pe="_sqlContainer_7w0ta_82",xe="_sqlHeader_7w0ta_87",_e="_sqlPreview_7w0ta_94",ye="_panelHeader_7w0ta_102",je="_resultsPanel_7w0ta_110",we="_explanationPanel_7w0ta_115",Ce="_explanationList_7w0ta_120",Ie="_quickActions_7w0ta_131",ge="_sqlPart_7w0ta_138",Se="_sqlPartCode_7w0ta_145",Ae="_explanationScroll_7w0ta_153",Le="_conceptList_7w0ta_157",Ne="_inputBadge_7w0ta_167",a={header:te,title:le,actions:ne,historyPanel:ie,historyItem:re,historyArrow:oe,querySection:ce,inputGroup:de,inputWrapper:he,inputIcon:me,queryInput:ue,sqlContainer:pe,sqlHeader:xe,sqlPreview:_e,panelHeader:ye,resultsPanel:je,explanationPanel:we,explanationList:Ce,quickActions:Ie,sqlPart:ge,sqlPartCode:Se,explanationScroll:Ae,conceptList:Le,inputBadge:Ne};function be(){const{isOpen:v,openSchema:D,closeSchema:k}=X(),[i,I]=o.useState(""),[h,g]=o.useState(""),[m,_]=o.useState(null),[b,S]=o.useState(!1),[W,A]=o.useState(!1),[L,P]=o.useState(!1),{colorScheme:d}=B(),E=G(),Q=[{natural:"Show me wells with high iron content in the last year",sql:"SELECT W.Well_ID, CA.Sample_Date, AI.Value FROM Wells W JOIN Chemical_Analysis CA..."},{natural:"Find wells with recent chemical analyses in Calgary",sql:"SELECT W.Well_ID, CA.Sample_Date FROM Wells W JOIN Chemical_Analysis CA..."}],T=s=>s.toLowerCase().includes("iron content")?`
SELECT 
  W.Well_ID,
  W.Latitude,
  W.Longitude,
  CA.Chemical_Analysis_ID,
  CA.Sample_Date,
  AI.Value,
  AI.Element_Name
FROM Wells W
JOIN Chemical_Analysis CA ON W.Well_ID = CA.Well_ID
JOIN Analysis_Items AI ON CA.Chemical_Analysis_ID = AI.Chemical_Analysis_ID
WHERE 
  AI.Element_Name = 'Iron'
  AND AI.Value > 0.3  -- Standard threshold for iron content
  AND CA.Sample_Date >= DATEADD(year, -1, GETDATE())
ORDER BY 
  CA.Sample_Date DESC;`.trim():"",y=(s,n)=>s.toLowerCase().includes("iron content")?{translation:{from:s,reasoning:["We'll need to join three tables to get this information:","1. Wells table for location data","2. Chemical_Analysis table for sample dates","3. Analysis_Items table for iron measurements"]},sqlBreakdown:[{part:"SELECT W.Well_ID, W.Latitude, W.Longitude, ...",explanation:"Getting well location and identification data"},{part:"JOIN Chemical_Analysis CA ON W.Well_ID = CA.Well_ID",explanation:"Connecting wells to their chemical analyses using Well_ID"},{part:"JOIN Analysis_Items AI ON CA.Chemical_Analysis_ID = AI.Chemical_Analysis_ID",explanation:"Connecting to specific chemical measurements using Chemical_Analysis_ID"},{part:"WHERE AI.Element_Name = 'Iron' AND AI.Value > 0.3",explanation:"Filtering for iron content above the standard threshold (0.3 mg/L)"}],concepts:["Multi-table JOIN operations","Date-based filtering","Chemical analysis thresholds","Result ordering by date"]}:{translation:{from:"",reasoning:[]},sqlBreakdown:[],concepts:[]},z=s=>s.toLowerCase().includes("iron content")?[{Well_ID:1001,Chemical_Analysis_ID:5001,Sample_Date:"2023-10-15",Value:.45,Element_Name:"Iron",Latitude:51.0447,Longitude:-114.0719},{Well_ID:1002,Chemical_Analysis_ID:5002,Sample_Date:"2023-09-20",Value:.52,Element_Name:"Iron",Latitude:51.0544,Longitude:-114.0667}]:[],N=async()=>{if(!i.trim()){r.show({title:"Empty Query",message:"Please enter your question first",color:"yellow"});return}S(!0);try{await new Promise(n=>setTimeout(n,1500));const s=T(i);g(s),_(null),r.show({title:"Query Generated",message:"SQL query is ready to execute",color:"teal"})}catch{r.show({title:"Generation Failed",message:"Could not generate SQL query",color:"red"})}finally{S(!1)}},R=async()=>{if(!h){r.show({title:"No SQL Query",message:"Generate a SQL query first",color:"yellow"});return}A(!0);try{await new Promise(n=>setTimeout(n,1e3));const s=z(i);_(s),r.show({title:"Query Executed",message:"Results are ready!",color:"teal"})}catch{r.show({title:"Execution Failed",message:"Could not execute SQL query",color:"red"})}finally{A(!1)}};return e.jsxs(H,{size:"xl",py:"xs",children:[e.jsxs("div",{className:a.header,children:[e.jsx(M,{order:2,className:a.title,children:e.jsx(t,{inherit:!0,component:"span",c:"#a3be8c",children:"SQL Playground"})}),e.jsxs("div",{className:a.actions,children:[e.jsx(u,{label:"Query History",children:e.jsx(p,{variant:"light",onClick:()=>P(!L),color:d==="dark"?"#d08770":"#5e81ac",children:e.jsx(se,{size:20})})}),e.jsx(u,{label:"View Schema",children:e.jsx(p,{variant:"light",onClick:D,color:d==="dark"?"#d08770":"#5e81ac",children:e.jsx(K,{size:20})})}),e.jsx(u,{label:"Saved Queries",children:e.jsx(p,{variant:"light",color:d==="dark"?"#d08770":"#5e81ac",children:e.jsx(Z,{size:20})})})]})]}),e.jsx(j,{in:L,children:e.jsx(w,{className:a.historyPanel,withBorder:!0,children:e.jsx(C,{h:150,children:Q.map((s,n)=>e.jsxs("button",{type:"button",className:a.historyItem,onClick:()=>{I(s.natural),g(""),_(null)},children:[e.jsxs("div",{children:[e.jsx(t,{size:"sm",fw:500,children:s.natural}),e.jsx(t,{size:"xs",c:"dimmed",children:s.sql})]}),e.jsx($,{size:16,className:a.historyArrow})]},n))})})}),e.jsxs(w,{className:a.querySection,withBorder:!0,children:[e.jsxs("div",{className:a.inputGroup,children:[e.jsxs("div",{className:a.inputWrapper,children:[e.jsx(ae,{size:20,className:a.inputIcon}),e.jsx(O,{placeholder:"Describe what you want to know about the wells data...",value:i,onChange:s=>I(s.target.value),onKeyPress:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),N())},className:a.queryInput})]}),e.jsx(f,{color:"#a3be8c",size:"md",loading:b,onClick:N,disabled:!i.trim(),children:"Generate SQL"})]}),e.jsx(j,{in:!!h,children:e.jsx("div",{className:a.sqlContainer,children:e.jsxs(c,{children:[e.jsxs(c.Col,{span:7,children:[e.jsxs("div",{className:a.sqlHeader,children:[e.jsx(t,{size:"sm",fw:500,c:"dimmed",children:"Generated SQL:"}),e.jsx(F,{gap:"xs",children:e.jsx(u,{label:"Copy SQL",children:e.jsx(p,{variant:"subtle",color:d==="dark"?"#d08770":"#5e81ac",onClick:()=>{E.copy(h),r.show({message:"SQL copied to clipboard",color:"teal"})},children:e.jsx(ee,{size:16})})})})]}),e.jsx(q,{block:!0,className:a.sqlPreview,children:h}),e.jsx(f,{variant:"light",color:d==="dark"?"#d08770":"#5e81ac",size:"sm",mt:"md",loading:W,onClick:R,fullWidth:!0,children:"Execute SQL Query"})]}),e.jsx(c.Col,{span:5,children:e.jsxs(C,{h:"31.5rem",className:a.explanationScroll,scrollbarSize:6,children:[e.jsx(t,{size:"sm",fw:500,mb:"xs",children:"From Natural Language to SQL:"}),y(i).translation.reasoning.map((s,n)=>e.jsx(t,{size:"sm",c:"dimmed",mb:"xs",children:s},n)),e.jsx(t,{size:"sm",fw:500,mt:"md",mb:"xs",children:"Query Breakdown:"}),y(i).sqlBreakdown.map((s,n)=>e.jsxs("div",{className:a.sqlPart,children:[e.jsx(q,{className:a.sqlPartCode,children:s.part}),e.jsx(t,{size:"sm",c:"dimmed",children:s.explanation})]},n)),e.jsx(t,{size:"sm",fw:500,mt:"md",mb:"xs",children:"Key Concepts Used:"}),e.jsx("ul",{className:a.conceptList,children:y(i).concepts.map((s,n)=>e.jsx("li",{children:e.jsx(t,{size:"sm",c:"dimmed",children:s})},n))})]})})]})})})]}),e.jsx(j,{in:!!m,children:e.jsxs(c,{gutter:"md",mt:"md",children:[e.jsx(c.Col,{span:8,children:e.jsxs(w,{className:a.resultsPanel,withBorder:!0,children:[e.jsxs("div",{className:a.panelHeader,children:[e.jsx(t,{fw:500,size:"sm",children:"Query Results"}),e.jsxs(V,{variant:"light",color:"teal",leftSection:e.jsx(U,{size:12}),children:[m?.length||0," Records Found"]})]}),e.jsx(C,{children:e.jsxs(l,{children:[e.jsx(l.Thead,{children:e.jsxs(l.Tr,{children:[e.jsx(l.Th,{children:"Well ID"}),e.jsx(l.Th,{children:"Sample Date"}),e.jsx(l.Th,{children:"Iron Value"}),e.jsx(l.Th,{children:"Location (Lat, Long)"})]})}),e.jsx(l.Tbody,{children:m?.map(s=>e.jsxs(l.Tr,{children:[e.jsx(l.Td,{children:s.Well_ID}),e.jsx(l.Td,{children:s.Sample_Date}),e.jsxs(l.Td,{children:[s.Value," mg/L"]}),e.jsx(l.Td,{children:`${s.Latitude.toFixed(4)}, ${s.Longitude.toFixed(4)}`})]},s.Well_ID))})]})})]})}),e.jsx(c.Col,{span:4,children:e.jsxs(J,{className:a.explanationPanel,withBorder:!0,children:[e.jsx(t,{fw:500,size:"sm",mb:"md",children:"Query Results Explained"}),e.jsxs(t,{size:"sm",c:"dimmed",mb:"md",children:["Found ",m?.length," wells with elevated iron content (",">","0.3 mg/L) in their chemical analysis from the past year."]}),e.jsxs("ul",{className:a.explanationList,children:[e.jsx("li",{children:"Iron levels above 0.3 mg/L may indicate water quality concerns"}),e.jsx("li",{children:"Results are ordered by sample date to show most recent first"}),e.jsx("li",{children:"Coordinates can be used for spatial analysis"})]})]})})]})}),e.jsx(Y,{opened:v,onClose:k})]})}export{be as PlaygroundMode};
